"0","# Assign coordinates ----"
"0","map.rows = sqrt(npix)"
"0","coords = as.matrix(expand.grid(x = as.double(1:map.cols), y = as.double(1:map.rows)))"
"0","stopifnot(nrow(coords) == npix)"
"0",""
"0","# Calculate varcov matrix ----"
"0","## Covmatrix()"
"0","system.time({"
"0","  covmat2 = CompRandFld::Covmatrix(coordx = coords, "
"0","                                   distance = dist.meth,"
"0","                                   corrmodel = cormod,"
"0","                                   param = corpars)"
"0","  invcholV = remotePARTS::invert_chol(covmat2$covmatrix)"
"0","})"
