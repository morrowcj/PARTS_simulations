"0","r.tmp = c(.05, 0.2, .5, 1)*map.cols"
"0",""
"0","a.tmp = c(.5, 1, 1.5, 2)"
"0",""
"0","spatcor.tab = data.frame(NULL)"
"0",""
"0","for (a in a.tmp) for (r in r.tmp){"
"0","  "
"0","  nugpars = list(scale = r, power = a, "
"0","               mean = 0, sill = 1, nugget = 0)"
"0","  "
"0","  nug.vcov = CompRandFld::Covmatrix(coords, "
"0","                                    distance = dist.meth, "
"0","                                    corrmodel = ""stable"", "
"0","                                    param = nugpars)$covmatrix"
"0","  # image(nug.vcov)"
"0","  spat.nug <- scales::rescale(mvtnorm::rmvnorm(n = 1, sigma = nug.vcov), to = constrain.nug)"
"0","  tmp = data.frame(coords, nug = as.vector(spat.nug), r = r/map.cols, a = a)"
"0","  spatcor.tab = rbind(spatcor.tab, tmp)"
"0","  "
"0","  # nug.corpars = list(scale = range, power = a, sill = psill, nugget = 0, mean = 0)"
"0","  # covmat = CompRandFld::Covmatrix(coordx = coords, "
"0","  #                                 distance = dist.meth,"
"0","  #                                 corrmodel = cormod,"
"0","  #                                 param = nug.corpars)$covmatrix"
"0","  # "
"0","  # covmat = diag(as.vector(spat.nug)) + (1-mean(as.vector(spat.nug)))*covmat"
"0","  # del = mvtnorm::rmvnorm(n = ntime, sigma = covmat, method = ""chol"")"
"0","  # eps = t(apply(X = del, MARGIN = 2, "
"0","  #               function(e){"
"0","  #                 arima.sim(n = ntime, "
"0","  #                           model = list(ar = rhos, ma = thetas), "
"0","  #                           innov = e)"
"0","  #               }))"
"0","  "
"0","}"
"0",""
"0","ggplot(data = spatcor.tab, aes(x = x, y = y, fill = nug)) +"
"0","  theme_classic() + "
"0","  theme(legend.position = ""none"","
"0","        panel.spacing = unit(0, ""lines"")) +"
"0","  geom_tile() + "
"0","  scale_fill_viridis_c(option = ""magma"") +"
"0","  facet_grid(r ~ a, labeller = ""label_both"") +"
"0","  labs(x = ""x coord"", y = ""y coord"", title = ""spatial patterns (stable exp covariance)"")"
