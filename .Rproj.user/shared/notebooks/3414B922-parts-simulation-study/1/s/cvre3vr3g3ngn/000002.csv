"0","# Map parameters ----"
"0",""
"0","# map.rows <- c(100, 150, 200, 280) # map row combinations"
"0","# stopifnot(all((map.rows^2) %% 4 == 0)) # check that the square is divisible by 4"
"0",""
"0",""
"0",""
"0","map.rows = 16"
"0","map.cols = map.rows"
"0","npix = map.rows * map.cols"
"0",""
"0","# simulation paramters ----"
"0","spat.range = .05 # effective range"
"0","nugget = .10"
"0","xsd = 1"
"0",""
"0","# Map calculations ----"
"0","## X, Y coordinates"
"0","coords = as.matrix(expand.grid(x = as.double(1:map.cols), "
"0","                               y = as.double(1:map.rows)))"
"0","## Distance"
"0","D.time = system.time(D <- scales::rescale(as.matrix(dist(coords)), to = c(0, 1)))"
"0",""
"0","## Covariance matrix"
"0","Sigma <- diag(rep(nugget, npix)) + (1 - nugget) * taper.sphr(D, spat.range)"
"0",""
"0","## Cholesky matrix"
"0","# Chol.time = system.time(Cholmat <- base::chol(Sigma))"
"0",""
"0","Chol.time2 = system.time(invchol <- remotePARTS::invert_chol(Sigma, nugget))"
