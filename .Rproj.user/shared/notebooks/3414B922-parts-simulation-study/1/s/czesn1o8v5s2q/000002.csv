"0","# B1*u1 + B2*u2 + R1*r1 + (p0 + p1*u1 + p2*u2 + R2*r2)*t + (g1 + R3*r3)*w1(t) + e(t)"
"0",""
"0","landcover = half.land"
"0",""
"0","# Intercepts"
"0","land.intercept = if(B1 == 0){rep(0, npix)}else{B1*as.vector(landcover)}"
"0","rand.intercept = if(R1 == 0){rep(0, npix)}else{(R1*rnorm(npix))}"
"0","int.effect = land.intercept + rand.intercept"
"0","int.mat = matrix(rep(int.effect, times = n.time), ncol = n.time)"
"0",""
"0","# Cime effects"
"0","land.time = if(p1 == 0){rep(0, npix)}else{p1*as.vector(landcover)}"
"0","rand.time = if(R2 == 0){rep(0, npix)}else{(R2*rnorm(npix))}"
"0","time.effect = (p0 + land.time + rand.time) %*% rbind(time)"
"0",""
"0","# Climate effects"
"0","w.del = t(scale(Dr %*% rnorm(npix)))"
"0","w = t(rbind(apply(X = w.del, MARGIN = 2,"
"0","                  function(e){"
"0","                    arima.sim(n = n.time,"
"0","                              model = list(ar = AR, ma = MA, innov = e))"
"0","                  })))"
"0","clim.par = g1 + if(R3 == 0){rep(0, npix)}else{R3*rnorm(npix)}"
"0","clim.mat = matrix(rep(clim.par, times = n.time), ncol = n.time)"
"0",""
"0","clim.effect = clim.mat*w"
"0",""
"0","X = int.mat + time.effect + clim.effect + vareps"
