"0","#---"
"0","## Initial Parameters"
"0","#---"
"0",""
"0","set.seed(3654)"
"0",""
"0","# Sim pars ----"
"0","burn.in = 0"
"0","sim.iters = 1"
"0",""
"0","# Map pars ----"
"0","map.cols = 20"
"0","map.rows = 10"
"0","npix = map.rows * map.cols # should be a square?"
"0",""
"0","# ARMA pars ----"
"0","rhos = c(0.6, 0.2)# AR parameter(s): must sum to less than 1"
"0","thetas = c(.4) # MA parameter: must be less than 1"
"0",""
"0","# Temporal pars ----"
"0","ntime = 30 # number of time points"
"0",""
"0","# varcov pars ----"
"0","cormod = ""stable"" # 'stable' correlation model: varcov = nug+sill*exp(-(d/scale)^shape)"
"0","dist.meth = ""Eucl"" # Euclidean distance"
"0","sill = 1 # sill (variance)"
"0","r = .25 # range of spatial autocor, relative to width of map (scale parameter)"
"0","a = 1 # shape of spatial autocor function (shape parameter)"
"0","nug = .2 # fixed nugget"
"0",""
"0","# spatial nugget pars ----"
"0","nug.cormod = ""matern"""
"0","nug.distmeth = ""Eucl"""
"0","nug.r = .4"
"0","nug.s = 20"
"0","constrain.nug = c(0, 1) # constrain the spatial nugget to these values"
"0",""
"0","# effect parameters ----"
"0","beta = .2 # spatial predictors"
"0","phi = .2 # spatio-temporal predictors"
"0","gamma = .5 # time trends"
"0",""
"0","# Additinal parameter calculations ----"
"0",""
"0","## Assign coordinates to pixels"
"0","coords = as.matrix(expand.grid(x = as.double(1:map.cols), "
"0","                               y = as.double(1:map.rows)))"
"0",""
"0","## spatial correlation"
"0","psill = sill - nug # partial sill: if nug is spatially variable, use mean(nug)"
"0","range = r * map.cols # range in pixels"
"0",""
"0","## spatially variable parameters"
"0","nug.range = nug.r * map.cols"
"0","nug.smooth = nug.s"
"0",""
"0",""
"0","# Sanity checks ----"
"0","stopifnot(sum(rhos) < 1)"
"0","stopifnot(nrow(coords) == npix)"
"0",""
"0","# parameter table ----"
"0",""
"0","fixed.pars = expand.grid(range = range, a = a, nug = nug, fixed.pars = TRUE)"
"0",""
"0",""
"0","corpars = list(scale = range, power = a, # parameter list for Covmatrix()"
"0","               sill = psill, nugget = nug, mean = 0)"
"0","nugpars = list(scale = nug.range, smooth = nug.smooth, "
"0","               mean = 0, sill = 1, nugget = 0)"
