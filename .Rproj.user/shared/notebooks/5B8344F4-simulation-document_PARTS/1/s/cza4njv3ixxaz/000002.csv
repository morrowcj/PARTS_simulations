"0","start.time = Sys.time()"
"0",""
"0","# Calculate varcov matrix (Sigma) ----"
"0","## Covmatrix() - easier to modify specs"
"0","covmat = CompRandFld::Covmatrix(coordx = coords, "
"0","                                 distance = dist.meth,"
"0","                                 corrmodel = cormod,"
"0","                                 param = corpars)$covmatrix"
"0",""
"0","covmat.tap = CompRandFld::Covmatrix(coordx = coords, "
"0","                                 distance = dist.meth,"
"0","                                 corrmodel = cormod, "
"0","                                 type = ""Tapering"", taper = ""Wendland1"", "
"0","                                 param = corpars)$covmatrix"
"0",""
"0","# invcholV = remotePARTS::invert_chol(covmat)"
"0",""
"0","# ## Tony's"
"0","# d = as.matrix(stats::dist(coords, method = ""euc""))"
"0","# d.scale = (d - min(d)) / (max(d) - min(d)) # rescale to (0, 1)"
"0","# covmat2 = diag(rep(nug, npix)) + (1 - nug) * exp(-(d/r)^a)"
"0","# invcholV2 = remotePARTS::invert_chol(covmat2)"
"0","# ## Same answer?"
"0","# all((covmat2 - covmat) == 0) # TRUE! - also no speed change"
