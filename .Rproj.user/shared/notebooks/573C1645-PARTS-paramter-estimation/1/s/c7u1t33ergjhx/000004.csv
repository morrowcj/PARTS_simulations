"0","set.seed(2) # set random seed"
"0",""
"0","## Calculate covariance matrix (the nugget is added to the diagonal to get cov(i,i) = nugget)"
"0","# Sigma = t(backsolve(chol(nugmat + (1 - nug) * covar_func(D, r)), diag(npix)))"
"0","Sigma = nugmat + (1 - nug) * covar_func(D, r)"
"0",""
"0","## Simulate a random spatial error structure"
"0","del = scale(Sigma %*% rnorm(npix))"
"0",""
"0","## view the spatial errors"
"0","ggplot(data.frame(coords, del), aes(x = x, y = y, fill = del)) +"
"0","  geom_tile() + labs(title = ""Spatial errors"") +"
"0","  scale_fill_viridis_c(option = ""magma"")"
