"0","## Add an effect of time plus the spatio-temporal errors"
"0",""
"0","lat.effect = matrix(rep(rep(lambda, npix)*coords[,2], times = ntime), ncol = ntime)"
"0","time.int.effect = rep(alpha, npix)"
"0","time.lat.effect = rep(beta, npix)*coords[,2]"
"0","time.effect = (time.int.effect + time.lat.effect) %*% rbind(1:ntime)"
"0",""
"0","X = lat.effect + time.effect + epsilon"
"0",""
"0","## Add the coordinates back into the data"
"0","Xdata = data.frame(coords, X)"
"0",""
"0","## Visualize the simulated data for each time point"
"0","Xdata %>% reshape2::melt(id.vars = c(""x"", ""y"")) %>%"
"0","  # filter(variable == ""X1"") %>% "
"0","  ggplot(aes(x = x, y = y, fill = value)) +"
"0","  geom_tile() +"
"0","  facet_wrap(~variable) +"
"0","  scale_fill_viridis_c(option = ""magma"")"
